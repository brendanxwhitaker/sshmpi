#!/bin/bash
update_hostsfile
mapfile -t nodes < ~/.all_hosts
for node in "${nodes[@]}"
do
    scp ~/.ssh/config cc-$node:~/.ssh/config &
    scp ~/.ssh/id_rsa cc-$node:~/.ssh/id_rsa &
done
for node in "${nodes[@]}"
do
    ssh cc-$node "update_hostsfile && pkill -e spout && rm remote.log" &
done
for node in "${nodes[@]}"
do
    ssh cc-$node "pip uninstall -y sshmpi && pip install git+git://github.com/brendanxwhitaker/sshmpi.git && rm ~/spout" &
done
